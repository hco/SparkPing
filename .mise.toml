[tools]
rust = "1.91.1"
node = "24"
"cargo:cargo-watch" = {version = "latest"}


[tasks.build]
description = "Build the project"
run = "cargo build"

[tasks.release]
description = "Build the project in release mode"
run = "cargo build --release"

[tasks.test]
description = "Run tests"
run = "cargo test"

[tasks.check]
description = "Check code without building"
run = "cargo check"

[tasks.fmt]
description = "Format code"
run = "cargo fmt"

[tasks.fmt-check]
description = "Check code formatting"
run = "cargo fmt --check"

[tasks.clippy]
description = "Run clippy linter"
run = "cargo clippy"

[tasks.clippy-pedantic]
description = "Run clippy with pedantic lints"
run = "cargo clippy -- -W clippy::pedantic"

[tasks.run]
description = "Run the project"
run = '''
if [[ "$(uname)" == "Darwin" ]]; then
  sudo cargo run
else
  cargo run
fi
'''

[tasks.dev]
description = "Run the project with watch support (auto-reload on file changes)"
run = '''
if [[ "$(uname)" == "Darwin" ]]; then
  sudo cargo watch -x run
else
  cargo watch -x run
fi
'''

[tasks.watch-check]
description = "Watch for changes and run cargo check (faster feedback loop)"
run = "cargo watch -x check"

[tasks.clean]
description = "Clean build artifacts"
run = "cargo clean"

[tasks.lint]
description = "Run all linting checks (fmt-check + clippy)"
run = "cargo fmt --check && cargo clippy"

[tasks.all]
description = "Run check, fmt-check, and clippy"
run = "cargo check && cargo fmt --check && cargo clippy"
